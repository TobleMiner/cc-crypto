Message, MessageAssoc = require('lib/cryptnet/message.lua')

msg = {type = Message.type.DEASSOC, id = 42, id_recipient = 23, id_a = 0, id_b = 42, keyid = 0, challenge = 'asdfasda', hmac = 'hitler'}

message = Message.parse(nil, msg)

function printTable(tbl, prefix)
	if not prefix then
		prefix = ''
	end
	
	for k,v in pairs(tbl) do
		print(prefix .. k .. ':')
		if type(v) == 'table' then
			printTable(v, prefix .. '\t')
		else
			print(prefix .. '\t' .. tostring(v))
		end
	end
end

printTable(message)
